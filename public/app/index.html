<!DOCTYPE html>
<html>
  <head>
		<title>Home</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.0.0/dist/css/materialize.min.css"
    />
		<link rel="dns-prefetch" href="https://fonts.googleapis.com/" >
		<link rel="dns-prefetch" href="https://i.ibb.co/" >
		<link rel="dns-prefetch" href="https://image.flaticon.com/" >
		<link rel="dns-prefetch" href="https://beta.manuthecoder.repl.co/" >

    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      rel="shortcut icon"
      href="https://image.flaticon.com/icons/png/512/5455/5455405.png"
    />
		<script 	src="https://beta.manuthecoder.repl.co/socket.io/socket.io.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://beta.manuthecoder.repl.co/v/style.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

		<!-- Primary Meta Tags -->
<meta name="title" content="EdPoll">
<meta name="description" content="EdPoll is a polling app for both schools and offices! Create website">
<meta property="og:url" content="https://edpoll.ga">
<meta property="og:title" content="EdPoll">
<meta property="og:description" content="EdPoll is a polling app for both schools and offices! Create your own poll now - No signup required!">
<meta property="og:image" content="https://i.ibb.co/4jQj7tF/s.pn">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://edpoll.ga">
<meta property="twitter:title" content="EdPoll">
<meta property="twitter:description" content="EdPoll is a polling app for both schools and offices! Create your own poll now - No signup required!">
<meta property="twitter:image" content="https://i.ibb.co/4jQj7tF/s.pn">
  </head>
  <body style="margin-top: 55px !important">
    <nav class="white" style="z-index: 9 !important">
      <ul>
        <li>
          <a href="https://beta.manuthecoder.repl.co">EdPoll</a>
        </li>
      </ul>
      <ul class="right">
        <li>
          <a
            href="javascript:void(0)"
            class="btn blue-grey darken-4 waves-effect waves-light"
            onclick="dark_mode()"
            style="
              padding: 0 7px !important;
              color: white !important;
              border-radius: 5px;
              margin-right: 0 !important;
            "
            ><i class="material-icons">dark_mode</i></a
          >
          <a
            href="./add"
            class="btn blue waves-effect waves-light"
            style="color: white !important; border-radius: 5px"
            >Create</a
          >
        </li>
      </ul>
    </nav>
    <style>
			.cardLoading {
				border: 5px solid white;
			}
			.waves-ripple {

			}
			.card {
				transition: all .2s !important;
				border: 1px solid #eee;
				box-shadow: none !important
			}
      .card:focus {
				border-color: #aaa !important;
				/* border: 1px solid black; */
				outline: 0;
			}
			img {
				box-shadow: 2px 2px 10px rgba(0, 0, 0, .4);
				border-radius: 4px;
			}
      .dark_mode input {
        color: white !important;
      }
      * {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
      }
    </style>
    <script src="../components.js"></script>
      <br />
			<div class="row">
				<div class="col s12 m8">
				</div>
				<div class="col s12 m4">
					<div class="input-field">
						<label for="search">Search...</label>
						<input type="text" id="search"></div>
				</div>
			</div>
      <div class="row loading" id="polls">
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
				<div class="cardLoading col s4" style="height: 200px;"></div>
			</div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.0.0/dist/js/materialize.min.js"
      type="text/javascript"
    ></script>
    <footer class="page-footer blue" style="padding: 0 !important">
      <div class="footer-copyright">
        <div class="container">
          Â© Copyright 2021 All rights reserved
          <a
            class="grey-text text-lighten-4 right"
            href="https://manuthecoder.ml"
            >A swag app by Manu!</a
          >
        </div>
      </div>
    </footer>
    <script>
			// const socket = io("wss://" + window.location.hostname);
      // socket.emit("message", "hi");
			window.onerror = function(msg, url, linenumber) {
    alert('Error message: '+msg+'\nURL: '+url+'\nLine Number: '+linenumber);
    return true;
}
      
      window.addEventListener("load", () => {
			
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
						const json = JSON.parse(this.responseText)
						document.getElementById("polls").innerHTML = "";
						$(document).ready(function(){
							$("#search").on("keyup", function() {
								var value = $(this).val().toLowerCase();
								if(value.trim() == "") {
									$("#polls .col.s12").addClass("m4")
								}
								$("#polls .col.s12").filter(function() {
									$(this).removeClass("m4")
									$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
								});
							});
						});
						document.getElementById("polls").innerHTML = `<div class="chips1 col s12"></div>`
						// [...new Set(array)]
						json.forEach((data, key) => {
						var cat = "";
						data.categories.forEach(d => {
							cat += `<div class="chip">${d}</div>`
						})
						// document.getElementById("polls").getElementsByClassName("chips1")[0].innerHTML += `${cat}`
            document.getElementById("polls").innerHTML += `<div class="col s12">
					<div class="card waves-effect" onclick="window.location = './v/${key}/'" tabindex="0" onkeyup="if(event.keyCode == 13) {window.location = './v/${key}/'}">
						<div class="card-content">
						<b><h5>${data.title}</h5></b>
						<p>${data.date}</p>
						<br>
						<p>${cat}</p>
						</div>
					</div>
				</div>`;
						})
          }
        };
        xhttp.open("GET", "./database/polls.json", true);
        xhttp.send();
      });


    </script>
  </body>
</html>