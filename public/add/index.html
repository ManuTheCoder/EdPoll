<!DOCTYPE html>
<html>
  <head>
		<title>Add</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.0.0/dist/css/materialize.min.css"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      rel="shortcut icon"
      href="https://image.flaticon.com/icons/png/512/5455/5455405.png"
    />
		<script 	src="https://beta.manuthecoder.repl.co/socket.io/socket.io.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://beta.manuthecoder.repl.co/v/style.css"
    />
			<script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		    <style>.fa { display: inline-block; padding-left: 10px; padding-top: 10px; cursor: unset;border-radius: 2px;padding-right: 13px; padding-bottom: 10px; font-size: 25px !important; width: 50px; text-align: center; text-decoration: none; margin: 5px 2px; } * { font-family: 'Poppins', sans-serif ; } .fa:hover { transform: scale(1.05) }.fa:active { transform: scale(.97) } .fa-facebook { background: #3B5998; color: white; } .fa-twitter { background: #55ACEE; color: white; } .fa-google { background: #dd4b39; color: white; } .fa-linkedin { background: #007bb5; color: white; } .fa-youtube { background: #bb0000; color: white; } .fa-instagram { background: #125688; color: white; } .fa-pinterest { background: #cb2027; color: white; } .fa-code { background: #f54245; color: white; } .fa-snapchat-ghost { background: #fffc00; color: white; text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black; } .fa-id-card { background: #00aff0; color: white; } .fa-skype { background: #00aff0; color: white; } .fa-android { background: #a4c639; color: white; } .fa-dribbble { background: #ea4c89; color: white; } .fa-vimeo { background: #45bbff; color: white; } .fa-tumblr { background: #2c4762; color: white; } .fa-book { background: #00b489; color: white; } .fa-address-book { background: #45bbff; color: white; } .fa-stumbleupon { background: #eb4924; color: white; } button[disabled] {background:#ccc !important} .fa-link { background: #f40083; color: white; } .fa-yahoo { background: #430297; color: white; } .fa-soundcloud { background: #ff5500; color: white; } .fa-reddit { background: #ff5700; color: white; } .fa-envelope { background: #ff6600; color: white; }
        .new {content: "New" !important}
        .js-copytextarea {caret-color: transparent !important}
        </style>
  </head>
  <body style="margin-top: 55px !important">
    <nav class="white" style="z-index: 9 !important">
      <ul>
        <li>
          <a href="https://beta.manuthecoder.repl.co">EdPoll</a>
        </li>
      </ul>
      <ul class="right">
        <li>
          <a
            href="javascript:void(0)"
            class="btn blue-grey darken-4 waves-effect waves-light"
            onclick="dark_mode()"
            style="
              padding: 0 7px !important;
              color: white !important;
              border-radius: 5px;
              margin-right: 0 !important;
            "
            ><i class="material-icons">dark_mode</i></a
          >
          <a
            href="https://edpoll.ga/add"
            class="btn grey waves-effect waves-light"
            style="color: white !important; pointer-events: none;border-radius: 5px"
            >Create</a
          >
        </li>
      </ul>
    </nav>
    <style>
      .dark_mode body {
        background: #212121 !important;
        color: white;
      }
			.chip {
				line-height: 30px !important;
			}
      .dark_mode .card {
        background: rgba(255, 255, 255, 0.1) !important;
      }
      .dark_mode .waves-effect .waves-ripple {
        background: rgba(255, 255, 255, 0.3) !important;
      }
      .dark_mode nav,
      .dark_mode footer {
        background: #303030 !important;
        box-shadow: none !important;
      }
      .dark_mode nav a {
        color: #fff !important;
      }
      .dark_mode input {
        color: white !important;
      }
    </style>
    <script defer>
      function dark_mode() {
        if (document.documentElement.classList.contains("dark_mode")) {
          document.documentElement.classList.remove("dark_mode");
          localStorage.setItem("dark_mode", "false");
        } else {
          document.documentElement.classList.add("dark_mode");
          localStorage.setItem("dark_mode", "true");
        }
      }
      window.addEventListener("load", () => {
        if (
          localStorage.getItem("dark_mode") &&
          localStorage.getItem("dark_mode") == "true"
        ) {
          document.documentElement.classList.add("dark_mode");
        }
      });
    </script>
    <div class="container" id="app" style="display: none">
      <br />
      <h3>
        <b>Add a poll</b>
      </h3>
			<div id="chip"></div>

			<form action="" onsubmit="return addPoll(event)">
				<div class="input-field">
					<label>Name</label>
					<input type="text" name="name" id="name" onkeyup="saveValue();localStorage.setItem('name', this.value)" required autocomplete="off">
				</div>
				<div class="input-field">
					<label>Options</label>
					<textarea class="materialize-textarea" style="min-height: 300px;" name="options" id="options" required autocomplete="off"></textarea>
				</div>
				<div class="input-field">
					<label>Description/Directions</label>
					<textarea class="materialize-textarea" style="min-height: 200px;" name="desc" id="desc" required autocomplete="off"></textarea>
				</div>
				<div class="input-field">
					<label>Categories</label>
					<input type="text" name="cat" id="categories" autocomplete="off">
					<p>Seperate categories with commas</p>
				</div>
				<button onclick="addPoll()" class="blue btn darken-3 waves-effect waves-light">
					Create
				</button>
				<br><br><br><br>
			</form>
    </div>
		<script src="../components.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@materializecss/materialize@1.0.0/dist/js/materialize.min.js"
      type="text/javascript"
    ></script>
    <footer class="page-footer blue" style="padding: 0 !important">
      <div class="footer-copyright">
        <div class="container">
          Â© Copyright 2021 All rights reserved
          <a
            class="grey-text text-lighten-4 right"
            href="https://manuthecoder.ml"
            >A swag app by Manu!</a
          >
        </div>
      </div>
    </footer>
		<script>
			var socket = io();
			var name = document.getElementById('name');
			var options = document.getElementById('options');
			var desc = document.getElementById('desc');
			var categories = document.getElementById('categories');
			function addPoll(e) {
				e.preventDefault();
				socket.emit("addPoll", document.getElementById('name').value, options.value, categories.value, desc.value)
				localStorage.clear();
				socket.on("newPollAdded", (data) => {
				// window.location.href = "../j/" + data
				history.pushState(null, null, "../j/" + data);
				id = data
				$("#app").load("view.html");
				socket.off("newPollAdded")
			})
			}

		
			function saveValue() {
				document.getElementById("chip").innerHTML = `	<div class="chip">
				<i class="material-icons left">sync</i>
				Saving...</div>`
				setTimeout(() => {
									document.getElementById("chip").innerHTML = `	<div class="chip">
									<i class="material-icons left">done_all</i>
									Saved to browser</div>`
				}, 200)
				// localStorage.setItem("name", name.value)
				localStorage.setItem("options", options.value)
				localStorage.setItem("desc", desc.value)
				localStorage.setItem("categories", categories.value);;
			}
			options.onkeyup =  saveValue;
			desc.onkeyup =  saveValue;
			categories.onkeyup =  saveValue;
			document.getElementById('name').value = localStorage.getItem("name") || ""
			options.value = localStorage.getItem("options") || ""
			desc.value = localStorage.getItem("desc") || ""
			categories.value = localStorage.getItem("categories") || ""
			function hasNumber(myString) {
  return /\d/.test(myString);
}
var id = 0;
if(hasNumber(window.location.href)) {
	id = window.location.href.replace(/\D/g, "")
	$("#app").load("https://" + window.location.hostname + "/add/view.html", () => {
		document.getElementById("app").style.display = "block"

	})
}
else {
	document.getElementById("app").style.display = "block"
}

			
		</script>
  </body>
</html>